
# STM32F4 Stepper Motor Music Player with ATK2MD5050 Driver 🎵+⚙️

## 📖 项目简介

基于STM32F407和ATK2MD5050驱动器的步进电机音乐播放系统，通过精确的PWM脉冲控制步进电机转速，将音乐转化为机械运动艺术。仅需脉冲和地线即可实现完整的音乐控制。

**作者**: RUN  
**完成时间**: 2025年10月20日  
**硬件平台**: STM32F407ZGT6  
**电机驱动器**: ATK2MD5050 
**控制方式**: 脉冲+方向（仅使用脉冲信号）

## 🎯 工作原理

### 声音的本质
**声音由物体振动产生**。振动越快（频率高），音调就越高；振动越慢（频率低），音调就越低。

### 步进电机的音乐化
- **基本作用**：每给步进电机一个脉冲，它就精确地移动一步
- **振动产生**：如果快速、连续地发送脉冲，电机就会持续振动
- **关键联系**：**控制脉冲的频率，就直接控制了电机振动的频率**

### 音乐生成机制
- 让电机以**262Hz**振动，它就发出中央C（C4）的音调
- 让电机以**440Hz**振动，它就发出标准音A（A4）的音调
- 微控制器按照乐谱，发送一串**不同频率**（对应音高）和**不同时长**（对应节拍）的脉冲
- 电机通过机械结构振动空气，从而演奏出完整的旋律
- 
## ✨ 项目特色

- 🎼 **极简接线** - 仅需脉冲和地线两根线控制
- ⚡ **高效驱动** - ATK2MD5050专业步进电机驱动
- 🎹 **精确控制** - 基于PWM脉冲的精确转速控制
- 🥁 **音乐同步** - 电机转速与音乐节奏完美对应
- 📚 **丰富曲库** - 多首经典乐曲的机械演奏版本

## 🛠️ 硬件要求

### 主要组件
- STM32F407ZGT6 开发板
- 步进电机（支持57、42、39等型号）
- ATK2MD5050 驱动器
- 12V直流电源
- 连接线若干

### 极简接线配置
| STM32引脚 | 连接目标 | 功能 |
|-----------|----------|------|
| PC6 | ATK2MD5050 PUL+ | 脉冲信号 |
| GND | ATK2MD5050 PUL- | 脉冲地线 |
| - | 电机电源+ | 12V直流 |
| - | 电机电源- | 电源地线 |

## 🎵 功能特性

### ATK2MD5050驱动特性
- **控制方式**: 脉冲方向控制
- **工作电压**: 12V
- **输出电流**: 0.5-5.0A可调
- **细分设置**: 支持多种细分模式
- **保护功能**: 过压、过流、短路保护

### 音乐控制特性
- **脉冲映射**: 音符频率→脉冲频率→电机转速
- **动态调速**: 实时PWM频率调整
- **平滑过渡**: 音符间的平滑转速变化
- **节拍精确**: 基于定时器的精确时长控制

## 🚀 快速开始

### 1. 极简硬件连接
```
STM32F407    ->    ATK2MD5050    ->    步进电机
PC6 (PWM)   ->     PUL+         ->     脉冲输入
GND         ->     PUL-         ->     脉冲地线
            ->     电源+        ->     12V
            ->     电源-        ->     电源地线
```
### 2.乐谱数据结构
- 本项目使用简单的二维数组定义乐谱，格式为：[音区, 音符, 时值]
- // 乐谱数组格式说明
- int my_song[][3] = {
- [音区, 音符, 时值]
-  音区: 0-低音, 1-中音, 2-高音  
-   音符: 1-7对应do,re,mi,fa,sol,la,si
 -  时值: 1-全音符, 2-二分音符, 4-四分音符, 8-八分音符
-   休止符: [0, 0, 时值]
- };


### 🎼 内置曲库

| 曲目名称 🎵 | 描述 📝 | 声学特性 🔊 | 状态 📊 |
|------------|---------|------------|--------|
| 《小星星》 | 经典儿童歌曲 | 清晰的中频音色 | ✅ 已完成 |
| 《名侦探柯南》 | 动漫主题曲 | 宽广的动态范围 | ✅ 已完成 |
| 《加勒比海盗》 | 电影主题曲 | 复杂的谐波结构 | ✅ 已完成 |
## 🎥 视频演示

项目演示视频已上传至本仓库，点击下方链接观看：

[📺 查看项目演示视频](https://github.com/user-attachments/assets/34c0a0f2-838e-4edc-9924-fe2477487e99)


📞有问题欢迎联系我们
作者: RUN
邮箱: 2046138442@qq.com
